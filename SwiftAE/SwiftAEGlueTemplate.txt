//
//  «GLUE_NAME»
//  «APPLICATION_NAME» «APPLICATION_VERSION»
//  «FRAMEWORK_NAME» «FRAMEWORK_VERSION»
//  `«AEGLUE_COMMAND»`
//


import Foundation


/******************************************************************************/
// Untargeted AppData instance used in App, Con, Its roots; also used by Application constructors to create their own targeted AppData instances

private let gNullAppData = AppData(glueInfo: GlueInfo(insertionSpecifierType: «PREFIX»Insertion.self, objectSpecifierType: «PREFIX»Object.self,
                                                      elementsSpecifierType: «PREFIX»Elements.self, rootSpecifierType: «PREFIX»Root.self,
                                                      symbolType: Symbol.self, formatter: gSpecifierFormatter))


/******************************************************************************/
// Specifier formatter

private let gSpecifierFormatter = SpecifierFormatter(applicationClassName: "«APPLICATION_CLASS_NAME»",
                                                     classNamePrefix: "«PREFIX»",
                                                     propertyNames: [«+PROPERTY_FORMATTER»
                                                                     «CODE»: "«NAME»", // '«CODE_STR»'
                                                     «-PROPERTY_FORMATTER»
                                                     ],
                                                     elementsNames: [«+ELEMENTS_FORMATTER»
                                                                     «CODE»: "«NAME»", // '«CODE_STR»'
                                                     «-ELEMENTS_FORMATTER»
                                                     ])


/******************************************************************************/
// Symbol subclass defines static type/enum/property constants based on «APPLICATION_NAME»'s terminology

public class «PREFIX»Symbol: Symbol {

    override var typeAliasName: String {return "«PREFIX»"}

    public override class func symbol(code: OSType, type: OSType = typeType, descriptor: NSAppleEventDescriptor? = nil) -> «PREFIX»Symbol {
        switch (code) {
«+SYMBOL_SWITCH»
        case «CODE»: return self.«NAME» // '«CODE_STR»'
«-SYMBOL_SWITCH»
        default: return super.symbol(code, type: type, descriptor: descriptor) as! «PREFIX»Symbol
        }
    }

    // Types/properties
«+TYPE_SYMBOL»
    public static let «NAME» = «PREFIX»Symbol(name: "«NAME»", code: «CODE», type: typeType) // '«CODE_STR»'
«-TYPE_SYMBOL»

    // Enumerators
«+ENUM_SYMBOL»
    public static let «NAME» = «PREFIX»Symbol(name: "«NAME»", code: «CODE», type: typeEnumerated) // '«CODE_STR»'
«-ENUM_SYMBOL»
}

public typealias «PREFIX» = «PREFIX»Symbol // allows symbols to be written as (e.g.) «PREFIX».name instead of «PREFIX»Symbol.name



/******************************************************************************/
// Specifier extensions; these add command methods and property/elements getters based on «APPLICATION_NAME»'s terminology

public protocol «PREFIX»Command: SpecifierProtocol {} // provides AE dispatch methods

extension «PREFIX»Command {

«+COMMAND»
    public func «COMMAND_NAME»(directParameter: Any = NoParameter,
«+PARAMETER»
            «NAME»: Any = NoParameter,
«-PARAMETER»
            waitReply: Bool = true, withTimeout: NSTimeInterval? = nil, considering: ConsideringOptions? = nil) throws -> Any {
        return try self.appData.sendAppleEvent("«COMMAND_NAME»", eventClass: «EVENT_CLASS», eventID: «EVENT_ID», // '«EVENT_CLASS_STR»«EVENT_ID_STR»'
                parentSpecifier: (self as! Specifier), directParameter: directParameter, keywordParameters: [
«+PARAMETER»
                    ("«NAME»", «CODE», «NAME»), // '«CODE_STR»'
«-PARAMETER»
                ], requestedType: nil, waitReply: waitReply, sendOptions: nil,
                withTimeout: withTimeout, considering: considering, asType: Any.self)
    }
«-COMMAND»
}


public protocol «PREFIX»Query: ObjectSpecifierExtension, «PREFIX»Command {} // provides vars and methods for constructing specifiers

extension «PREFIX»Query {
    
    // Properties
«+PROPERTY_SPECIFIER»
    public var «NAME»: «PREFIX»Object {return self.property(«CODE») as! «PREFIX»Object} // '«CODE_STR»'
«-PROPERTY_SPECIFIER»

    // Elements
«+ELEMENTS_SPECIFIER»
    public var «NAME»: «PREFIX»Elements {return self.elements(«CODE») as! «PREFIX»Elements} // '«CODE_STR»'
«-ELEMENTS_SPECIFIER»
}


/******************************************************************************/
// Specifier subclasses add app-specific extensions

public class «PREFIX»Insertion: InsertionSpecifier, «PREFIX»Command {}

public class «PREFIX»Object: ObjectSpecifier, «PREFIX»Query {
    public typealias InsertionSpecifierType = «PREFIX»Insertion
    public typealias ObjectSpecifierType = «PREFIX»Object
    public typealias ElementsSpecifierType = «PREFIX»Elements
}

public class «PREFIX»Elements: «PREFIX»Object, ElementsSpecifierExtension {}

public class «PREFIX»Root: RootSpecifier, «PREFIX»Query, RootSpecifierExtension {
    public typealias InsertionSpecifierType = «PREFIX»Insertion
    public typealias ObjectSpecifierType = «PREFIX»Object
    public typealias ElementsSpecifierType = «PREFIX»Elements
    public override class var nullAppData: AppData { return gNullAppData }
}

public class «APPLICATION_CLASS_NAME»: «PREFIX»Root, ApplicationExtension {
«+DEFAULT_INIT»

    public convenience init(launchOptions: LaunchOptions = DefaultLaunchOptions, relaunchMode: RelaunchMode = DefaultRelaunchMode) {
        self.init(rootObject: AppRootDesc, appData: self.dynamicType.nullAppData.targetCopy(
                                .BundleIdentifier("«BUNDLE_IDENTIFIER»", true), launchOptions: launchOptions, relaunchMode: relaunchMode))
    }
«-DEFAULT_INIT»
}

// App/Con/Its root objects used to construct untargeted specifiers; these can be used to construct specifiers for use in commands, though cannot send commands themselves

public let «PREFIX»App = gNullAppData.rootObjects.app as! «PREFIX»Root
public let «PREFIX»Con = gNullAppData.rootObjects.con as! «PREFIX»Root
public let «PREFIX»Its = gNullAppData.rootObjects.its as! «PREFIX»Root

