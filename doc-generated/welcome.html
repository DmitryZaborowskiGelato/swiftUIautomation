<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>SwiftAutomation | Welcome</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style type="text/css" media="all"><!--@import url(full.css);--></style>
    </head>
    <body>
        <div id="wrap">
            <div id="main">
                <h1>Welcome</h1>
                <div class="navbar"><a href="index.html">index</a> | <a href="tutorial-introduction.html">next</a></div>
                <h2>What is SwiftAutomation?</h2>

<p>SwiftAutomation allows you to control "AppleScriptable" macOS applications using Apple Inc's <a href="https://swift.org/">Swift programming language</a>. SwiftAutomation makes Swift a true alternative to AppleScript for automating your Mac.</p>

<p>For example, to get the value of the first paragraph of the topmost document in TextEdit:</p>

<pre><code>let result = try TextEdit().documents[1].paragraphs[1].get() as String
</code></pre>

<p>This is equivalent to the AppleScript statement:</p>

<pre><code>tell application id "com.apple.TextEdit" to get paragraph 1 of document 1
</code></pre>

<p>Or to create a new "Hello World!" document in TextEdit:</p>

<pre><code>// tell application id "com.apple.TextEdit"
//   make new document with properties {text:"Hello World!"}
// end tell

let textedit = TextEdit()
try textedit.make(new: TED.document, withProperties: [TED.text: "Hello World!"])
</code></pre>

<h2>Getting SwiftAutomation</h2>

<p>To clone the <a href="https://bitbucket.org/hhas/swiftae">SwiftAutomation repository</a> to your own machine:</p>

<pre><code>git clone https://bitbucket.org/hhas/swiftae.git
</code></pre>

<p>Minimum requirements: macOS 10.11 and Xcode 8.1/Swift 3.0.1.</p>

<p>When working through the SwiftAutomation tutorial and writing <code>#!/usr/bin/swift</code> "scripts" that are compiled and executed each time they are run, the simplest way to get started is to build the SwiftAE project's Release target and then create symlinks to the SwiftAutomation and MacOSGlues frameworks in <code>/Library/Frameworks</code>:</p>

<pre><code>cd /Library/Frameworks
sudo ln -s <var>/path/to/</var>Build/Products/Release/SwiftAutomation.framework
sudo ln -s <var>/path/to/</var>Build/Products/Release/MacOSGlues.framework</code></pre>

<p>and a symlink to the AppleScriptToSwift application in <code>/Applications</code>:</p>

<pre><code>cd /Applications
sudo ln -s <var>/path/to/</var>Build/Products/Release/AppleScriptToSwift.app</code></pre>

<p class="hilitebox">When using these frameworks, remember that Swift does not yet provide a stable ABI so Swift programs can only import frameworks compiled with <em>exactly</em> the same version of Swift. Therefore you must rebuild these frameworks whenever you install a new version of Xcode/Swift. [TO DO: what about embedding in CLI and GUI apps? easiest would be to link to instructions in Swift/Xcode docs]</p>

<h2>Before you start...</h2>

<p>In order to use SwiftAutomation effectively, you will need to understand the differences between the Apple event and Swift/Cocoa object systems.</p>

<p>In contrast to the familiar object-oriented approach of other inter-process communication systems such as COM and Distributed Objects, Apple event IPC is based on a combination of remote procedure calls and first-class queries - somewhat analogous to using XPath over XML-RPC.</p>

<p>While SwiftAutomation uses an object-oriented-like syntax for conciseness and readability, like AppleScript, it behaves according to Apple event rules. As a result, Swift users will discover that some things work differently in SwiftAutomation from what they're used to. For example:</p>

<ul>
<li><p>Object elements are one-indexed, not zero-indexed like Swift Arrays.</p></li>
<li><p>Referencing a property of an application object does not automatically return the property's value (you need a get command for that).</p></li>
<li><p>Many applications allow a single command to operate on multiple objects at the same time, providing significant performance benefits when manipulating large numbers of application objects. (Conversely, sending lots of commands to manipulate single objects one at a time can severely degrade performance.)</p></li>
</ul>

<p>Chapters 2 and 3 of this manual provide further information on how Apple event IPC works and a tutorial-based introduction to the SwiftAutomation bridge. Chapters 4 and 10 explain how to generate glue files for controlling specific appications. Chapters 5 through 9 cover the SwiftAutomation API, and chapter 11 discusses techniques for optimising performance.</p>

            </div>
        </div>
        <div id="footer"><div class="navbar"><a href="index.html">index</a> | <a href="tutorial-introduction.html">next</a></div></div>
    </body>
</html>
